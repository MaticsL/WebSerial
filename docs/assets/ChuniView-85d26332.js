import{_ as V,r as m,o as v,c as P,a as u,b as s,w as d,d as f,e as _,F as N,f as h}from"./index-33d6f0e7.js";const S={data(){return{headMessageType:"warning",firmVersion:0,connecting:!1,connected:!1,lastmessage:"请选择设备",sliderType:1,portNum:null,eepromAddr:255,connectPercentage:0,eepromValue:0,lightColor:"#000000",brightness:250,keyType:1,closeColor:"#000000",keyTypeMark:{1:"32k",2:"16k",3:"8k",4:"4k"},brightnessMark:{0:"关闭",1:"10%",2:"20%",3:"30%",4:"40%",5:"50%",6:"60%",7:"70%",8:"80%",9:"90%",10:"100%"},sensitive:8,sensiStep:1,sensiMin:5,sensiMax:64,debugEnabledCount:0,debugEnabled:!1}},methods:{debugenable(){this.debugEnabledCount+=1,this.debugEnabledCount>=5&&(this.debugEnabled=!0)},getWriteRomPacket(e,r){return new Uint8Array([33,64,35,35,28,e,0,r,r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},getHelloPacket(){return new Uint8Array([33,64,35,35,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},getReadRomPacket(e){return new Uint8Array([33,64,35,35,29,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},async readEEPROM(){let e=this;var r=e.portNum.writable.getWriter(),i=e.portNum.readable.getReader(),c=e.getReadRomPacket(e.eepromAddr);await r.write(c);for(var t=0,n="";t<=2;){var a=await i.read();t++;for(var l in a.value)String.fromCharCode(a.value[l])!="A"&&(n=n+String.fromCharCode(a.value[l]))}e.eepromValue=parseInt(n),i.releaseLock(),r.releaseLock()},async writeEEPROM(){let e=this;var r=e.portNum.writable.getWriter(),i=e.getWriteRomPacket(e.eepromAddr,e.eepromValue);await r.write(i),r.releaseLock()},async writeKeyLayout(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),i=e.portNum.readable.getReader(),c=e.getWriteRomPacket(94,e.keyType);await r.write(c);var t=e.getReadRomPacket(94);await r.write(t);for(var n=0,a="";n<=2;){var l=await i.read();n++;for(var x in l.value)String.fromCharCode(l.value[x])!="A"&&(a=a+String.fromCharCode(l.value[x]))}e.keyType=parseInt(a),i.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！键型在下次连接手台时生效。"}},async writeBrightness(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),i=e.portNum.readable.getReader(),c=e.getWriteRomPacket(98,e.brightness);await r.write(c);var t=e.getReadRomPacket(98);await r.write(t);for(var n=0,a="";n<=2;){var l=await i.read();n++;for(var x in l.value)String.fromCharCode(l.value[x])!="A"&&(a=a+String.fromCharCode(l.value[x]))}e.brightness=parseInt(a),i.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！亮度在下次连接手台时生效。"}},async writeSensitive(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),i=e.portNum.readable.getReader(),c=e.getWriteRomPacket(84,e.sensitive);await r.write(c);var t=e.getReadRomPacket(84);await r.write(t);for(var n=0,a="";n<=2;){var l=await i.read();n++;for(var x in l.value)String.fromCharCode(l.value[x])!="A"&&(a=a+String.fromCharCode(l.value[x]))}e.sensitive=parseInt(a),i.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！灵敏度在下次连接手台时生效。"}},async choosePort(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(R){e.lastmessage="端口选择错误："+R;return}try{await e.portNum.open({baudRate:1e6})}catch(R){e.lastmessage="打开端口错误："+R;return}e.connecting=!0,e.connectPercentage=0;var r=e.getHelloPacket(),i=e.portNum.writable.getWriter(),c=e.portNum.readable.getReader();await i.write(r);for(var t="",n=!1;t.length<=20&&!n;){var a=await c.read();for(var l in a.value)String.fromCharCode(a.value[l])!="A"&&(t=t+String.fromCharCode(a.value[l])),t.endsWith("XDEN chunicon v2.")&&(n=!0)}if(!n){e.lastmessage="打开端口错误：请选择正确的设备!";return}e.connectPercentage=30;var x=e.getReadRomPacket(7);await i.write(x);for(var o=0,p="";o<=2;){var a=await c.read();o++;for(var l in a.value)String.fromCharCode(a.value[l])!="A"&&(p=p+String.fromCharCode(a.value[l]))}e.connectPercentage=50;var b=e.getReadRomPacket(84);await i.write(b);for(var o=0,k="";o<=2;){var a=await c.read();o++;for(var l in a.value)String.fromCharCode(a.value[l])!="A"&&(k=k+String.fromCharCode(a.value[l]))}e.sensitive=parseInt(k),e.connectPercentage=70;var w=e.getReadRomPacket(98);await i.write(w);for(var o=0,g="";o<=2;){var a=await c.read();o++;for(var l in a.value)String.fromCharCode(a.value[l])!="A"&&(g=g+String.fromCharCode(a.value[l]))}e.brightness=parseInt(g),(e.brightness>255||e.brightness<0)&&(e.brightness=255),e.connectPercentage=80;var y=e.getReadRomPacket(94);await i.write(y);for(var o=0,C="";o<=2;){var a=await c.read();o++;for(var l in a.value)String.fromCharCode(a.value[l])!="A"&&(C=C+String.fromCharCode(a.value[l]))}e.connectPercentage=90,e.keyType=parseInt(C),(e.keyType>4||e.keyType<1)&&(e.keyType=1),e.connecting=!1,e.lastmessage="已选择控制器: XDEN chunicon v2. 固件版本: "+p,e.firmVersion=parseInt(p),e.headMessageType="success",c.releaseLock(),i.releaseLock(),e.connected=!0}else e.lastmessage="您的浏览器不支持串口通信，请使用chrome浏览器。"}}},E=u("br",null,null,-1),A={key:0},M={slot:"header"},T=u("span",null,"灵敏度配置",-1),L=u("br",null,null,-1),W=u("br",null,null,-1),I={slot:"header"},U=u("span",null,"亮度配置",-1),B=u("br",null,null,-1),O={slot:"header"},j=u("span",null,"键型配置",-1),D=u("br",null,null,-1),F=u("div",{slot:"header"},[u("span",null,"危险区域！")],-1);function H(e,r,i,c,t,n){const a=m("el-divider"),l=m("el-alert"),x=m("el-button"),p=m("el-col"),b=m("el-row"),k=m("el-progress"),w=m("el-slider"),g=m("el-card");m("el-color-picker");const y=m("el-input-number");return v(),P(N,null,[u("h2",{onClick:r[0]||(r[0]=(...o)=>n.debugenable&&n.debugenable(...o))},"chuni （白色）24-27 寸控制器配置"),s(a),s(l,{title:"提示",type:"info",description:"本页面提供 chuni（白色版本）4-6air 24-27寸控制器的配置功能。请确认您的控制器符合这个版本。完成配置后，您可以直接关闭这个页面。","show-icon":""}),E,s(b,null,{default:d(()=>[s(p,{span:4},{default:d(()=>[s(x,{onClick:n.choosePort,disabled:t.connected},{default:d(()=>[h("连接控制器")]),_:1},8,["onClick","disabled"])]),_:1}),s(p,{span:20},{default:d(()=>[s(l,{title:t.lastmessage,type:t.headMessageType,closable:!1},null,8,["title","type"])]),_:1})]),_:1}),t.connecting?(v(),P("br",A)):f("",!0),t.connecting?(v(),_(k,{key:1,percentage:t.connectPercentage},null,8,["percentage"])):f("",!0),s(a),t.connected?(v(),_(g,{key:2},{default:d(()=>[u("div",M,[T,s(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:n.writeSensitive},{default:d(()=>[h("写入灵敏度")]),_:1},8,["disabled","onClick"])]),L,s(l,{title:"提示",type:"info",description:"向左升高灵敏度，向右降低灵敏度，推荐带灯版本灵敏度8-11之间，不带灯版灵敏度32-45之间。","show-icon":""}),s(w,{modelValue:t.sensitive,"onUpdate:modelValue":r[1]||(r[1]=o=>t.sensitive=o),"show-tooltip":!0,step:t.sensiStep,min:t.sensiMin,max:t.sensiMax,"show-input":""},null,8,["modelValue","step","min","max"])]),_:1})):f("",!0),W,t.firmVersion>=10?(v(),_(g,{key:3},{default:d(()=>[u("div",I,[U,s(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:n.writeBrightness},{default:d(()=>[h("写入亮度配置")]),_:1},8,["disabled","onClick"])]),s(w,{modelValue:t.brightness,"onUpdate:modelValue":r[2]||(r[2]=o=>t.brightness=o),"show-tooltip":!1,step:1,min:0,marks:t.brightnessMark,max:10},null,8,["modelValue","marks"])]),_:1})):f("",!0),B,f("",!0),t.firmVersion>=10?(v(),_(g,{key:5},{default:d(()=>[u("div",O,[j,s(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:n.writeKeyLayout},{default:d(()=>[h("写入键型配置")]),_:1},8,["disabled","onClick"])]),D,s(l,{title:"提示",type:"info",description:"键型：32k为几乎覆盖全键盘，8k为asdfjkl;，4k为dfjk。","show-icon":""}),s(w,{modelValue:t.keyType,"onUpdate:modelValue":r[5]||(r[5]=o=>t.keyType=o),"show-tooltip":!1,step:1,min:1,marks:t.keyTypeMark,max:4},null,8,["modelValue","marks"])]),_:1})):f("",!0),t.connected&&t.debugEnabled?(v(),_(g,{key:6},{default:d(()=>[F,s(y,{modelValue:t.eepromAddr,"onUpdate:modelValue":r[6]||(r[6]=o=>t.eepromAddr=o),min:0,max:255,label:"地址"},null,8,["modelValue"]),s(y,{modelValue:t.eepromValue,"onUpdate:modelValue":r[7]||(r[7]=o=>t.eepromValue=o),min:0,max:255,label:"值"},null,8,["modelValue"]),s(x,{type:"primary",onClick:n.readEEPROM},{default:d(()=>[h("读取")]),_:1},8,["onClick"]),s(x,{type:"danger",onClick:n.writeEEPROM},{default:d(()=>[h("写入")]),_:1},8,["onClick"])]),_:1})):f("",!0)],64)}const X=V(S,[["render",H]]);export{X as default};
