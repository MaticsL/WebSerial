import{_ as y,r as p,o as h,c as C,a as d,b as l,w as r,e as v,d as f,F as S,f as c}from"./index-d72091e5.js";const A={data(){return{headMessageType:"warning",lastmessage:"请选择设备",selectedArea:"none",portNum:null,connected:!1,halting:!1,touchingArea:[],touchingIntervalID:0,readingData:new Uint8Array,RatioSetting:{area:null,value:null},SensitivitySetting:{area:null,value:null},debugEnabledCount:0,debugEnabled:!1}},methods:{getSensePacket(e,a){var t=new TextEncoder().encode("sen "+e+" "+a+`
`);return t},async addSensitivity(){let e=this;if(e.connected){var a=e.portNum.writable.getWriter(),t=e.getSensePacket("*","-");await a.write(t),a.releaseLock()}},async minusSensitivity(){let e=this;if(e.connected){var a=e.portNum.writable.getWriter(),t=e.getSensePacket("*","+");await a.write(t),a.releaseLock()}},async addAreaSensitivity(){let e=this;if(e.connected){var a=e.portNum.writable.getWriter(),t=e.getSensePacket(e.selectedArea,"-");await a.write(t),a.releaseLock()}},async minusAreaSensitivity(){let e=this;if(e.connected){var a=e.portNum.writable.getWriter(),t=e.getSensePacket(e.selectedArea,"+");await a.write(t),a.releaseLock()}},debugenable(){this.debugEnabledCount+=1,this.debugEnabledCount>=5&&(this.debugEnabled=!0)},async setBrightness(e){var t=this.portNum.writable.getWriter(),o=new TextEncoder().encode("bri "+e.toString()+`
`);await t.write(o),t.releaseLock()},submitRatio(){this.RatioSetting.area==null||this.RatioSetting.value==null},submitSensitivity(){},async set1p(){var a=this.portNum.writable.getWriter(),t=new TextEncoder().encode(`1p
`);await a.write(t),a.releaseLock()},async set2p(){var a=this.portNum.writable.getWriter(),t=new TextEncoder().encode(`2p
`);await a.write(t),a.releaseLock()},async setKeyboard(){var a=this.portNum.writable.getWriter(),t=new TextEncoder().encode(`out key
`);await a.write(t),a.releaseLock()},async setIO(){var a=this.portNum.writable.getWriter(),t=new TextEncoder().encode(`out io
`);await a.write(t),a.releaseLock()},async setDouble(){var a=this.portNum.writable.getWriter(),t=new TextEncoder().encode(`out double
`);await a.write(t),a.releaseLock()},async setNoOutput(){var a=this.portNum.writable.getWriter(),t=new TextEncoder().encode(`out none
`);await a.write(t),a.releaseLock()},async factoryMode(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(a){e.lastmessage="端口选择错误："+a;return}try{await e.portNum.open({baudRate:1200}),await e.portNum.setSignals({dataTerminalReady:!1})}catch{}e.lastmessage="成功，请检查控制器盘符并放入固件",e.headMessageType="success"}},asciiToUint8(e){let a="";for(let o=0;o<e.length;o++){const i=e.charCodeAt(o).toString(16).padStart(2,"0");a+=i+" "}return a=a.trim(),Uint8Array.from(a.split(" ").map(o=>parseInt(o,16)))},test(){console.log(this.asciiToUint8("{LAr2}"))},async startTouchListening(){let e=this;for(;!this.halting;){let a=e.portNum.getReader();for(;;){const{value:t,done:o}=await a.read();if(o)break;e.readingData=new Uint8Array,t[7]&1&&e.readingData.push("A1"),t[7]&2&&e.readingData.push("A2"),t[7]&4&&e.readingData.push("A3"),t[7]&8&&e.readingData.push("A4"),t[7]&16&&e.readingData.push("A5"),t[6]&1&&e.readingData.push("A6"),t[6]&2&&e.readingData.push("A7"),t[6]&4&&e.readingData.push("A8"),t[6]&8&&e.readingData.push("B1"),t[6]&16&&e.readingData.push("B2"),t[5]&1&&e.readingData.push("B3"),t[5]&2&&e.readingData.push("B4"),t[5]&4&&e.readingData.push("B5"),t[5]&8&&e.readingData.push("B6"),t[5]&16&&e.readingData.push("B7"),t[4]&1&&e.readingData.push("B8"),t[4]&2&&e.readingData.push("C1"),t[4]&4&&e.readingData.push("C2"),t[4]&8&&e.readingData.push("D1"),t[4]&16&&e.readingData.push("D2"),t[3]&1&&e.readingData.push("D3"),t[3]&2&&e.readingData.push("D4"),t[3]&4&&e.readingData.push("D5"),t[3]&8&&e.readingData.push("D6"),t[3]&16&&e.readingData.push("D7"),t[2]&1&&e.readingData.push("D8"),t[2]&2&&e.readingData.push("E1"),t[2]&4&&e.readingData.push("E2"),t[2]&8&&e.readingData.push("E3"),t[2]&16&&e.readingData.push("E4"),t[1]&1&&e.readingData.push("E5"),t[1]&2&&e.readingData.push("E6"),t[1]&4&&e.readingData.push("E7"),t[1]&8&&e.readingData.push("E8")}}},async resetSensitivity(){let e=this;if(e.connected){var a=e.portNum.writable.getWriter(),t=e.getSensePacket("*","0");await a.write(t);var t=e.getSensePacket("A6","1");await a.write(t);var t=e.getSensePacket("B1","2");await a.write(t);var t=e.getSensePacket("B2","2");await a.write(t);var t=e.getSensePacket("B5","1");await a.write(t);var t=e.getSensePacket("B6","1");await a.write(t);var t=e.getSensePacket("B7","1");await a.write(t);var t=e.getSensePacket("B8","1");await a.write(t);var t=e.getSensePacket("C1","5");await a.write(t);var t=e.getSensePacket("C2","5");await a.write(t);var t=e.getSensePacket("D5","-");await a.write(t);var t=e.getSensePacket("D7","-");await a.write(t);var t=e.getSensePacket("D8","-");await a.write(t);var t=e.getSensePacket("E1","1");await a.write(t);var t=e.getSensePacket("E2","5");await a.write(t),a.releaseLock()}},async senseMode(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(a){e.lastmessage="端口选择错误："+a;return}try{await e.portNum.open({baudRate:1e6})}catch(a){e.lastmessage="打开端口错误："+a;return}e.connected=!0,e.lastmessage="成功连接"}},async choosePort(){let e=this;if(this.connected==!0){this.halting==!0?(this.asciiToUint8("{STAT}"),this.halting=!this.halting,e.lastmessage="退出配置设置",this.startTouchListening()):(this.asciiToUint8("{HALT}"),this.halting=!this.halting,e.lastmessage="退出屏幕测试");return}if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(u){e.lastmessage="端口选择错误："+u;return}try{await e.portNum.open({baudRate:1e6})}catch(u){e.lastmessage="打开端口错误："+u;return}e.connecting=!0,e.connectPercentage=0;let a=e.asciiToUint8("{RSET}"),t=e.asciiToUint8("{HALT}"),o=e.portNum.writable.getWriter();await o.write(a),await o.write(t),connected=!connected,e.lastmessage="成功连接",e.headMessageType="success",e.startTouchListening()}else e.lastmessage="您的浏览器不支持串口通信，请使用chrome浏览器。"}}},B=d("br",null,null,-1),E=d("br",null,null,-1),T=d("h2",null,"12p切换",-1),N=d("br",null,null,-1),P=d("h2",null,"输出切换",-1),L=d("br",null,null,-1),x=d("h2",null,"修改亮度",-1),W=d("br",null,null,-1),R=d("h2",null,"修改全部灵敏度",-1),V=d("br",null,null,-1),U=d("h2",null,"修改区域灵敏度",-1),M=d("br",null,null,-1);function I(e,a,t,o,u,i){const D=p("el-divider"),b=p("el-alert"),s=p("el-button"),w=p("el-col"),_=p("el-row"),k=p("el-card"),n=p("el-option"),m=p("el-select");return h(),C(S,null,[d("h2",{onClick:a[0]||(a[0]=(...g)=>i.debugenable&&i.debugenable(...g))},"HDX 配置"),l(D),l(b,{title:"提示",type:"info",description:"本页面提供 HDX 乌蒙风格控制器的配置功能。请确认您的控制器符合这个版本。完成配置后，您可以直接关闭这个页面。","show-icon":""}),B,l(_,null,{default:r(()=>[l(w,{span:4},{default:r(()=>[l(s,{onClick:i.factoryMode},{default:r(()=>[c("进入刷机模式")]),_:1},8,["onClick"])]),_:1}),l(w,{span:4},{default:r(()=>[l(s,{onClick:i.senseMode},{default:r(()=>[c("修改灵敏度")]),_:1},8,["onClick"])]),_:1}),f("",!0),l(w,{span:16},{default:r(()=>[l(b,{title:u.lastmessage,type:u.headMessageType,closable:!1},null,8,["title","type"])]),_:1})]),_:1}),E,u.connected?(h(),v(k,{key:0},{default:r(()=>[T,l(s,{span:4,onClick:i.set1p},{default:r(()=>[c(" 1p ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.set2p},{default:r(()=>[c(" 2p ")]),_:1},8,["onClick"])]),_:1})):f("",!0),N,u.connected?(h(),v(k,{key:1},{default:r(()=>[P,l(s,{span:4,onClick:i.setIO},{default:r(()=>[c(" IO ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.setKeyboard},{default:r(()=>[c(" 键盘 ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.setDouble},{default:r(()=>[c(" IO+键盘 ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.setNoOutput},{default:r(()=>[c(" 无 ")]),_:1},8,["onClick"])]),_:1})):f("",!0),L,u.connected?(h(),v(k,{key:2},{default:r(()=>[x,l(s,{span:3,onClick:a[1]||(a[1]=g=>i.setBrightness(0))},{default:r(()=>[c(" 0% ")]),_:1}),l(s,{span:3,onClick:a[2]||(a[2]=g=>i.setBrightness(29))},{default:r(()=>[c(" 20% ")]),_:1}),l(s,{span:3,onClick:a[3]||(a[3]=g=>i.setBrightness(58))},{default:r(()=>[c(" 40% ")]),_:1}),l(s,{span:3,onClick:a[4]||(a[4]=g=>i.setBrightness(87))},{default:r(()=>[c(" 60% ")]),_:1}),l(s,{span:3,onClick:a[5]||(a[5]=g=>i.setBrightness(116))},{default:r(()=>[c(" 80% ")]),_:1}),l(s,{span:3,onClick:a[6]||(a[6]=g=>i.setBrightness(145))},{default:r(()=>[c(" 100% ")]),_:1})]),_:1})):f("",!0),W,u.connected?(h(),v(k,{key:3},{default:r(()=>[R,l(s,{span:4,onClick:i.addSensitivity},{default:r(()=>[c(" 提高灵敏度 ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.minusSensitivity},{default:r(()=>[c(" 降低灵敏度 ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.resetSensitivity},{default:r(()=>[c(" 重置灵敏度 ")]),_:1},8,["onClick"])]),_:1})):f("",!0),V,u.connected?(h(),v(k,{key:4},{default:r(()=>[U,l(_,{gutter:20},{default:r(()=>[l(w,{span:8},{default:r(()=>[l(m,{modelValue:u.selectedArea,"onUpdate:modelValue":a[7]||(a[7]=g=>u.selectedArea=g),placeholder:"触摸区域",inline:!0},{default:r(()=>[l(n,{label:"A1",value:"A1"}),l(n,{label:"A2",value:"A2"}),l(n,{label:"A3",value:"A3"}),l(n,{label:"A4",value:"A4"}),l(n,{label:"A5",value:"A5"}),l(n,{label:"A6",value:"A6"}),l(n,{label:"A7",value:"A7"}),l(n,{label:"A8",value:"A8"}),l(n,{label:"B1",value:"B1"}),l(n,{label:"B2",value:"B2"}),l(n,{label:"B3",value:"B3"}),l(n,{label:"B4",value:"B4"}),l(n,{label:"B5",value:"B5"}),l(n,{label:"B6",value:"B6"}),l(n,{label:"B7",value:"B7"}),l(n,{label:"B8",value:"B8"}),l(n,{label:"C1",value:"C1"}),l(n,{label:"C2",value:"C2"}),l(n,{label:"D1",value:"D1"}),l(n,{label:"D2",value:"D2"}),l(n,{label:"D3",value:"D3"}),l(n,{label:"D4",value:"D4"}),l(n,{label:"D5",value:"D5"}),l(n,{label:"D6",value:"D6"}),l(n,{label:"D7",value:"D7"}),l(n,{label:"D8",value:"D8"}),l(n,{label:"E1",value:"E1"}),l(n,{label:"E2",value:"E2"}),l(n,{label:"E3",value:"E3"}),l(n,{label:"E4",value:"E4"}),l(n,{label:"E5",value:"E5"}),l(n,{label:"E6",value:"E6"}),l(n,{label:"E7",value:"E7"}),l(n,{label:"E8",value:"E8"})]),_:1},8,["modelValue"])]),_:1}),l(w,{span:8},{default:r(()=>[l(s,{span:4,onClick:i.addAreaSensitivity},{default:r(()=>[c(" 提高灵敏度 ")]),_:1},8,["onClick"]),l(s,{span:4,onClick:i.minusAreaSensitivity},{default:r(()=>[c(" 降低灵敏度 ")]),_:1},8,["onClick"])]),_:1})]),_:1}),M]),_:1})):f("",!0),f("",!0),f("",!0)],64)}const q=y(A,[["render",I]]);export{q as default};
