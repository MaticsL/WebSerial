import{_ as W,r as g,o as f,c as S,a as s,b as n,w as m,d as v,e as k,F as A,f as h}from"./index-782cab6c.js";const T={data(){return{headMessageType:"warning",firmVersion:0,connecting:!1,connected:!1,zhou_io_enabled:!0,keyboard_enabled:!1,lastmessage:"请选择设备",sliderType:1,portNum:null,eepromAddr:255,connectPercentage:0,eepromValue:0,lightColor:"#000000",brightness:250,keyType:1,closeColor:"#000000",keyTypeMark:{1:"32k",2:"16k",3:"8k",4:"4k"},sliderLatencyMark:{0:"0ms",1:"3ms",2:"6ms",3:"9ms",4:"12ms",5:"15ms",6:"18ms",7:"21ms",8:"24ms",9:"27ms",10:"30ms",11:"33ms",12:"36ms",13:"39ms",14:"42ms"},sliderLatency:1,brightnessMark:{0:"关闭",1:"10%",2:"20%",3:"30%",4:"40%",5:"50%",6:"60%",7:"70%",8:"80%",9:"90%",10:"100%"},sensitive:20,sensiStep:1,sensiMin:10,sensiMax:64,debugEnabledCount:0,debugEnabled:!1}},methods:{debugenable(){this.debugEnabledCount+=1,this.debugEnabledCount>=5&&(this.debugEnabled=!0)},getWriteRomPacket(e,a){return new Uint8Array([33,64,35,35,28,e,0,a,a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},getHelloPacket(){return new Uint8Array([33,64,35,35,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},getReadRomPacket(e){return new Uint8Array([33,64,35,35,29,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},async readEEPROM(){let e=this;var a=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),i=e.getReadRomPacket(e.eepromAddr);await a.write(i);for(var t=0,d="";t<=2;){var r=await o.read();t++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(d=d+String.fromCharCode(r.value[l]))}e.eepromValue=parseInt(d),o.releaseLock(),a.releaseLock()},async writeEEPROM(){let e=this;var a=e.portNum.writable.getWriter(),o=e.getWriteRomPacket(e.eepromAddr,e.eepromValue);await a.write(o),a.releaseLock()},async writeKeyLayout(){let e=this;if(e.connected&&e.portNum!=null){var a=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),i=e.getWriteRomPacket(94,e.keyType);await a.write(i);var t=e.getReadRomPacket(94);await a.write(t),o.releaseLock(),a.releaseLock(),e.lastmessage="写入成功！键型在下次连接手台时生效。"}},async writeBrightness(){let e=this;if(e.connected&&e.portNum!=null){var a=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),i=e.getWriteRomPacket(98,e.brightness);await a.write(i);var t=e.getReadRomPacket(98);await a.write(t),o.releaseLock(),a.releaseLock(),e.lastmessage="写入成功！亮度在下次连接手台时生效。"}},async writeSliderLatency(){let e=this;if(e.connected&&e.portNum!=null){var a=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),i=e.getWriteRomPacket(247,e.sliderLatency);await a.write(i);var t=e.getReadRomPacket(247);await a.write(t),o.releaseLock(),a.releaseLock(),e.lastmessage="写入成功！亮度在下次连接手台时生效。"}},async writeInput(){let e=this;if(e.connected&&e.portNum!=null){var a=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),i,t;e.zhou_io_enabled?i=e.getWriteRomPacket(101,1):i=e.getWriteRomPacket(101,2),e.keyboard_enabled?t=e.getWriteRomPacket(100,1):t=e.getWriteRomPacket(100,2),await a.write(i);for(var d=0;d<3;)await o.read(),d++;await a.write(t),o.releaseLock(),a.releaseLock(),e.lastmessage="写入成功！输出模式在下次连接手台时生效。"}},async writeSensitive(){let e=this;if(e.connected&&e.portNum!=null){var a=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),i=e.getWriteRomPacket(84,e.sensitive);await a.write(i);var t=e.getReadRomPacket(84);await a.write(t),o.releaseLock(),a.releaseLock(),e.lastmessage="写入成功！灵敏度在下次连接手台时生效。"}},async choosePort(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(L){e.lastmessage="端口选择错误："+L;return}try{await e.portNum.open({baudRate:1e6})}catch(L){e.lastmessage="打开端口错误："+L;return}e.connecting=!0,e.connectPercentage=0;var a=e.getHelloPacket(),o=e.portNum.writable.getWriter(),i=e.portNum.readable.getReader();await o.write(a);for(var t="",d=!1;t.length<=27&&!d;){var r=await i.read();for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(t=t+String.fromCharCode(r.value[l])),t.endsWith("XDEN chunicon v3-32 model 2.")&&(d=!0),t.endsWith("XDEN chunicon v3-32 model 1.")&&(d=!0)}if(!d){e.lastmessage="打开端口错误：请选择正确的设备!";return}e.connectPercentage=20;var x=e.getReadRomPacket(7);await o.write(x);for(var c=0,_="";c<=2;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(_=_+String.fromCharCode(r.value[l]))}e.connectPercentage=40;var R=e.getReadRomPacket(101);await o.write(R);for(var c=0,w="";c<=1;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(w=w+String.fromCharCode(r.value[l]))}w*1==1?e.zhou_io_enabled=!0:e.zhou_io_enabled=!1;var C=e.getReadRomPacket(100);await o.write(C);for(var c=0,p="";c<=1;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(p=p+String.fromCharCode(r.value[l]))}p*1==1?e.keyboard_enabled=!0:e.keyboard_enabled=!1,e.connectPercentage=50;var b=e.getReadRomPacket(84);await o.write(b);for(var c=0,y="";c<=2;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(y=y+String.fromCharCode(r.value[l]))}e.sensitive=parseInt(y),e.connectPercentage=70;var u=e.getReadRomPacket(98);await o.write(u);for(var c=0,P="";c<=2;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(P=P+String.fromCharCode(r.value[l]))}e.brightness=parseInt(P),(e.brightness>255||e.brightness<0)&&(e.brightness=255);var E=e.getReadRomPacket(247);await o.write(E);for(var c=0,V="";c<=2;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(V=V+String.fromCharCode(r.value[l]))}e.sliderLatency=parseInt(V),(e.sliderLatency>14||e.sliderLatency<0)&&(e.sliderLatency=1),e.connectPercentage=80;var M=e.getReadRomPacket(94);await o.write(M);for(var c=0,N="";c<=2;){var r=await i.read();c++;for(var l in r.value)String.fromCharCode(r.value[l])!="A"&&(N=N+String.fromCharCode(r.value[l]))}e.connectPercentage=90,e.keyType=parseInt(N),(e.keyType>4||e.keyType<1)&&(e.keyType=1),e.connecting=!1,e.lastmessage="已选择控制器: XDEN chunicon v2. 固件版本: "+_,e.firmVersion=parseInt(_),e.headMessageType="success",i.releaseLock(),o.releaseLock(),e.connected=!0}else e.lastmessage="您的浏览器不支持串口通信，请使用chrome浏览器。"},async factoryMode(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(a){e.lastmessage="端口选择错误："+a;return}try{await e.portNum.open({baudRate:1200}),await e.portNum.setSignals({dataTerminalReady:!1})}catch(a){e.lastmessage="打开端口错误："+a;return}e.lastmessage="成功，请检查控制器盘符并放入固件",e.headMessageType="success"}}}},U=s("br",null,null,-1),I={key:0},z={slot:"header"},B=s("span",null,"输出配置",-1),O=s("br",null,null,-1),D=s("br",null,null,-1),H={slot:"header"},X=s("span",null,"灵敏度阈值配置",-1),j=s("br",null,null,-1),q=s("br",null,null,-1),F={slot:"header"},J=s("span",null,"亮度配置",-1),K=s("br",null,null,-1),Q=s("br",null,null,-1),Y={slot:"header"},Z=s("span",null,"键型配置",-1),G=s("br",null,null,-1),$=s("br",null,null,-1),ee={slot:"header"},te=s("span",null,"Slider延迟配置",-1),ae=s("br",null,null,-1),re=s("div",{slot:"header"},[s("span",null,"危险区域！")],-1);function le(e,a,o,i,t,d){const r=g("el-divider"),l=g("el-alert"),x=g("el-button"),_=g("el-col"),R=g("el-row"),w=g("el-progress"),C=g("el-checkbox"),p=g("el-card"),b=g("el-slider");g("el-color-picker");const y=g("el-input-number");return f(),S(A,null,[s("h2",{onClick:a[0]||(a[0]=(...u)=>d.debugenable&&d.debugenable(...u))},"chuni32寸控制器配置"),n(r),n(l,{title:"提示",type:"info",description:"本页面提供 chun32 寸控制器的配置功能。请确认您的控制器符合这个版本。完成配置后，您可以直接关闭这个页面。","show-icon":""}),U,n(R,null,{default:m(()=>[n(_,{span:4},{default:m(()=>[n(x,{onClick:d.factoryMode,disabled:t.connected},{default:m(()=>[h("进入刷机模式")]),_:1},8,["onClick","disabled"])]),_:1}),n(_,{span:4},{default:m(()=>[n(x,{onClick:d.choosePort,disabled:t.connected},{default:m(()=>[h("连接控制器")]),_:1},8,["onClick","disabled"])]),_:1}),n(_,{span:16},{default:m(()=>[n(l,{title:t.lastmessage,type:t.headMessageType,closable:!1},null,8,["title","type"])]),_:1})]),_:1}),t.connecting?(f(),S("br",I)):v("",!0),t.connecting?(f(),k(w,{key:1,percentage:t.connectPercentage},null,8,["percentage"])):v("",!0),n(r),t.connected?(f(),k(p,{key:2},{default:m(()=>[s("div",z,[B,n(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:d.writeInput},{default:m(()=>[h("写入输出配置")]),_:1},8,["disabled","onClick"])]),O,n(l,{title:"提示",type:"info",description:"手台可以调节输出键盘按键或舟HID，请根据需要选择，也可以都输出。","show-icon":""}),s("div",null,[n(C,{modelValue:t.zhou_io_enabled,"onUpdate:modelValue":a[1]||(a[1]=u=>t.zhou_io_enabled=u),label:"舟io",border:"",size:"large"},null,8,["modelValue"]),n(C,{modelValue:t.keyboard_enabled,"onUpdate:modelValue":a[2]||(a[2]=u=>t.keyboard_enabled=u),label:"键盘输出",border:"",size:"large"},null,8,["modelValue"])])]),_:1})):v("",!0),D,t.connected?(f(),k(p,{key:3},{default:m(()=>[s("div",H,[X,n(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:d.writeSensitive},{default:m(()=>[h("写入灵敏度")]),_:1},8,["disabled","onClick"])]),j,n(l,{title:"提示",type:"info",description:"向左升高灵敏度，向右降低灵敏度。","show-icon":""}),n(b,{modelValue:t.sensitive,"onUpdate:modelValue":a[3]||(a[3]=u=>t.sensitive=u),"show-tooltip":!0,step:t.sensiStep,min:t.sensiMin,max:t.sensiMax,"show-input":""},null,8,["modelValue","step","min","max"])]),_:1})):v("",!0),q,t.firmVersion>=10?(f(),k(p,{key:4},{default:m(()=>[s("div",F,[J,n(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:d.writeBrightness},{default:m(()=>[h("写入亮度配置")]),_:1},8,["disabled","onClick"])]),n(b,{modelValue:t.brightness,"onUpdate:modelValue":a[4]||(a[4]=u=>t.brightness=u),"show-tooltip":!1,step:1,min:0,marks:t.brightnessMark,max:10},null,8,["modelValue","marks"])]),_:1})):v("",!0),K,v("",!0),Q,t.firmVersion>=11?(f(),k(p,{key:6},{default:m(()=>[s("div",Y,[Z,n(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:d.writeKeyLayout},{default:m(()=>[h("写入键型配置")]),_:1},8,["disabled","onClick"])]),G,n(l,{title:"提示",type:"info",description:"键型：32k为几乎覆盖全键盘，8k为asdfjkl;，4k为dfjk。","show-icon":""}),n(b,{modelValue:t.keyType,"onUpdate:modelValue":a[7]||(a[7]=u=>t.keyType=u),"show-tooltip":!1,step:1,min:1,marks:t.keyTypeMark,max:4},null,8,["modelValue","marks"])]),_:1})):v("",!0),$,t.firmVersion>=13?(f(),k(p,{key:7},{default:m(()=>[s("div",ee,[te,n(x,{style:{float:"right"},type:"primary",disabled:!t.connected,onClick:d.writeSliderLatency},{default:m(()=>[h("写入延迟配置")]),_:1},8,["disabled","onClick"])]),ae,n(l,{title:"提示",type:"info",description:"Slider延迟，用于平衡air延迟使用，可以设置0-14档，每档大约3ms","show-icon":""}),n(b,{modelValue:t.sliderLatency,"onUpdate:modelValue":a[8]||(a[8]=u=>t.sliderLatency=u),"show-tooltip":!1,step:1,min:0,marks:t.sliderLatencyMark,max:14},null,8,["modelValue","marks"])]),_:1})):v("",!0),t.connected&&t.debugEnabled?(f(),k(p,{key:8},{default:m(()=>[re,n(y,{modelValue:t.eepromAddr,"onUpdate:modelValue":a[9]||(a[9]=u=>t.eepromAddr=u),min:0,max:255,label:"地址"},null,8,["modelValue"]),n(y,{modelValue:t.eepromValue,"onUpdate:modelValue":a[10]||(a[10]=u=>t.eepromValue=u),min:0,max:255,label:"值"},null,8,["modelValue"]),n(x,{type:"primary",onClick:d.readEEPROM},{default:m(()=>[h("读取")]),_:1},8,["onClick"]),n(x,{type:"danger",onClick:d.writeEEPROM},{default:m(()=>[h("写入")]),_:1},8,["onClick"])]),_:1})):v("",!0)],64)}const oe=W(T,[["render",le]]);export{oe as default};
