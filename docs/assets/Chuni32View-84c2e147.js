import{_ as W,r as v,o as p,c as L,a as d,b as i,w as x,d as f,e as _,F as T,f as h}from"./index-1808785f.js";const A={data(){return{headMessageType:"warning",firmVersion:0,connecting:!1,connected:!1,zhou_io_enabled:!0,keyboard_enabled:!1,lastmessage:"请选择设备",sliderType:1,portNum:null,eepromAddr:255,connectPercentage:0,eepromValue:0,lightColor:"#000000",brightness:250,keyType:1,closeColor:"#000000",keyTypeMark:{1:"32k",2:"16k",3:"8k",4:"4k"},sliderLatencyMark:{0:"0ms",1:"3ms",2:"6ms",3:"9ms",4:"12ms",5:"15ms",6:"18ms",7:"21ms",8:"24ms",9:"27ms",10:"30ms",11:"33ms",12:"36ms",13:"39ms",14:"42ms"},sliderLatency:1,brightnessMark:{0:"关闭",1:"10%",2:"20%",3:"30%",4:"40%",5:"50%",6:"60%",7:"70%",8:"80%",9:"90%",10:"100%"},sensitive:20,sensiStep:1,sensiMin:10,sensiMax:64,debugEnabledCount:0,debugEnabled:!1}},methods:{debugenable(){this.debugEnabledCount+=1,this.debugEnabledCount>=5&&(this.debugEnabled=!0)},getWriteRomPacket(e,r){return new Uint8Array([33,64,35,35,28,e,0,r,r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},getHelloPacket(){return new Uint8Array([33,64,35,35,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},getReadRomPacket(e){return new Uint8Array([33,64,35,35,29,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},async readEEPROM(){let e=this;var r=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),s=e.getReadRomPacket(e.eepromAddr);await r.write(s);for(var a=0,n="";a<=2;){var t=await o.read();a++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(n=n+String.fromCharCode(t.value[l]))}e.eepromValue=parseInt(n),o.releaseLock(),r.releaseLock()},async writeEEPROM(){let e=this;var r=e.portNum.writable.getWriter(),o=e.getWriteRomPacket(e.eepromAddr,e.eepromValue);await r.write(o),r.releaseLock()},async writeKeyLayout(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),s=e.getWriteRomPacket(94,e.keyType);await r.write(s);var a=e.getReadRomPacket(94);await r.write(a);for(var n=0,t="";n<=2;){var l=await o.read();n++;for(var c in l.value)t=t+String.fromCharCode(l.value[c])}e.keyType=parseInt(t),o.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！键型在下次连接手台时生效。"}},async writeBrightness(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),s=e.getWriteRomPacket(98,e.brightness);await r.write(s);var a=e.getReadRomPacket(98);await r.write(a);for(var n=0,t="";n<=2;){var l=await o.read();n++;for(var c in l.value)t=t+String.fromCharCode(l.value[c])}e.brightness=parseInt(t),o.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！亮度在下次连接手台时生效。"}},async writeSliderLatency(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),s=e.getWriteRomPacket(247,e.sliderLatency);await r.write(s);var a=e.getReadRomPacket(247);await r.write(a);for(var n=0,t="";n<=2;){var l=await o.read();n++;for(var c in l.value)t=t+String.fromCharCode(l.value[c])}e.sliderLatency=parseInt(t),o.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！亮度在下次连接手台时生效。"}},async writeInput(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),s,a;e.zhou_io_enabled?s=e.getWriteRomPacket(101,1):s=e.getWriteRomPacket(101,2),e.keyboard_enabled?a=e.getWriteRomPacket(100,1):a=e.getWriteRomPacket(100,2),await r.write(s);for(var n=0;n<3;)await o.read(),n++;await r.write(a),o.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！输出模式在下次连接手台时生效。"}},async writeSensitive(){let e=this;if(e.connected&&e.portNum!=null){var r=e.portNum.writable.getWriter(),o=e.portNum.readable.getReader(),s=e.getWriteRomPacket(84,e.sensitive);await r.write(s);var a=e.getReadRomPacket(84);await r.write(a);for(var n=0,t="";n<=2;){var l=await o.read();n++;for(var c in l.value)t=t+String.fromCharCode(l.value[c])}e.sensitive=parseInt(t),o.releaseLock(),r.releaseLock(),e.lastmessage="写入成功！灵敏度在下次连接手台时生效。"}},async choosePort(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(S){e.lastmessage="端口选择错误："+S;return}try{await e.portNum.open({baudRate:1e6})}catch(S){e.lastmessage="打开端口错误："+S;return}e.connecting=!0,e.connectPercentage=0;var r=e.getHelloPacket(),o=e.portNum.writable.getWriter(),s=e.portNum.readable.getReader();await o.write(r);for(var a="",n=!1;a.length<=27&&!n;){var t=await s.read();for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(a=a+String.fromCharCode(t.value[l])),a.endsWith("XDEN chunicon v3-32 model 2.")&&(n=!0),a.endsWith("XDEN chunicon v3-32 model 1.")&&(n=!0)}if(!n){e.lastmessage="打开端口错误：请选择正确的设备!";return}e.connectPercentage=20;var c=e.getReadRomPacket(7);await o.write(c);for(var u=0,k="";u<=2;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(k=k+String.fromCharCode(t.value[l]))}e.connectPercentage=40;var R=e.getReadRomPacket(101);await o.write(R);for(var u=0,b="";u<=1;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(b=b+String.fromCharCode(t.value[l]))}b*1==1?e.zhou_io_enabled=!0:e.zhou_io_enabled=!1;var C=e.getReadRomPacket(100);await o.write(C);for(var u=0,g="";u<=1;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(g=g+String.fromCharCode(t.value[l]))}g*1==1?e.keyboard_enabled=!0:e.keyboard_enabled=!1,e.connectPercentage=50;var w=e.getReadRomPacket(84);await o.write(w);for(var u=0,y="";u<=2;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(y=y+String.fromCharCode(t.value[l]))}e.sensitive=parseInt(y),e.connectPercentage=70;var m=e.getReadRomPacket(98);await o.write(m);for(var u=0,P="";u<=2;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(P=P+String.fromCharCode(t.value[l]))}e.brightness=parseInt(P),(e.brightness>255||e.brightness<0)&&(e.brightness=255);var E=e.getReadRomPacket(247);await o.write(E);for(var u=0,V="";u<=2;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(V=V+String.fromCharCode(t.value[l]))}e.sliderLatency=parseInt(V),(e.sliderLatency>14||e.sliderLatency<0)&&(e.sliderLatency=1),e.connectPercentage=80;var M=e.getReadRomPacket(94);await o.write(M);for(var u=0,N="";u<=2;){var t=await s.read();u++;for(var l in t.value)String.fromCharCode(t.value[l])!="A"&&(N=N+String.fromCharCode(t.value[l]))}e.connectPercentage=90,e.keyType=parseInt(N),(e.keyType>4||e.keyType<1)&&(e.keyType=1),e.connecting=!1,e.lastmessage="已选择控制器: XDEN chunicon v2. 固件版本: "+k,e.firmVersion=parseInt(k),e.headMessageType="success",s.releaseLock(),o.releaseLock(),e.connected=!0}else e.lastmessage="您的浏览器不支持串口通信，请使用chrome浏览器。"},async factoryMode(){let e=this;if("serial"in navigator){try{e.portNum=await navigator.serial.requestPort()}catch(r){e.lastmessage="端口选择错误："+r;return}try{await e.portNum.open({baudRate:1200}),await e.portNum.setSignals({dataTerminalReady:!1})}catch(r){e.lastmessage="打开端口错误："+r;return}e.lastmessage="成功，请检查控制器盘符并放入固件",e.headMessageType="success"}}}},I=d("br",null,null,-1),U={key:0},z={slot:"header"},B=d("span",null,"输出配置",-1),O=d("br",null,null,-1),D=d("br",null,null,-1),H={slot:"header"},X=d("span",null,"灵敏度阈值配置",-1),j=d("br",null,null,-1),q=d("br",null,null,-1),F={slot:"header"},J=d("span",null,"亮度配置",-1),K=d("br",null,null,-1),Q={slot:"header"},Y=d("span",null,"键型配置",-1),Z=d("br",null,null,-1),G={slot:"header"},$=d("span",null,"Slider延迟配置",-1),ee=d("br",null,null,-1),ae=d("div",{slot:"header"},[d("span",null,"危险区域！")],-1);function te(e,r,o,s,a,n){const t=v("el-divider"),l=v("el-alert"),c=v("el-button"),k=v("el-col"),R=v("el-row"),b=v("el-progress"),C=v("el-checkbox"),g=v("el-card"),w=v("el-slider");v("el-color-picker");const y=v("el-input-number");return p(),L(T,null,[d("h2",{onClick:r[0]||(r[0]=(...m)=>n.debugenable&&n.debugenable(...m))},"chuni32寸控制器配置"),i(t),i(l,{title:"提示",type:"info",description:"本页面提供 chun32 寸控制器的配置功能。请确认您的控制器符合这个版本。完成配置后，您可以直接关闭这个页面。","show-icon":""}),I,i(R,null,{default:x(()=>[i(k,{span:4},{default:x(()=>[i(c,{onClick:n.factoryMode,disabled:a.connected},{default:x(()=>[h("进入刷机模式")]),_:1},8,["onClick","disabled"])]),_:1}),i(k,{span:4},{default:x(()=>[i(c,{onClick:n.choosePort,disabled:a.connected},{default:x(()=>[h("连接控制器")]),_:1},8,["onClick","disabled"])]),_:1}),i(k,{span:16},{default:x(()=>[i(l,{title:a.lastmessage,type:a.headMessageType,closable:!1},null,8,["title","type"])]),_:1})]),_:1}),a.connecting?(p(),L("br",U)):f("",!0),a.connecting?(p(),_(b,{key:1,percentage:a.connectPercentage},null,8,["percentage"])):f("",!0),i(t),a.connected?(p(),_(g,{key:2},{default:x(()=>[d("div",z,[B,i(c,{style:{float:"right"},type:"primary",disabled:!a.connected,onClick:n.writeInput},{default:x(()=>[h("写入输出配置")]),_:1},8,["disabled","onClick"])]),O,i(l,{title:"提示",type:"info",description:"手台可以调节输出键盘按键或舟HID，请根据需要选择，也可以都输出。","show-icon":""}),d("div",null,[i(C,{modelValue:a.zhou_io_enabled,"onUpdate:modelValue":r[1]||(r[1]=m=>a.zhou_io_enabled=m),label:"舟io",border:"",size:"large"},null,8,["modelValue"]),i(C,{modelValue:a.keyboard_enabled,"onUpdate:modelValue":r[2]||(r[2]=m=>a.keyboard_enabled=m),label:"键盘输出",border:"",size:"large"},null,8,["modelValue"])])]),_:1})):f("",!0),D,a.connected?(p(),_(g,{key:3},{default:x(()=>[d("div",H,[X,i(c,{style:{float:"right"},type:"primary",disabled:!a.connected,onClick:n.writeSensitive},{default:x(()=>[h("写入灵敏度")]),_:1},8,["disabled","onClick"])]),j,i(l,{title:"提示",type:"info",description:"向左升高灵敏度，向右降低灵敏度。","show-icon":""}),i(w,{modelValue:a.sensitive,"onUpdate:modelValue":r[3]||(r[3]=m=>a.sensitive=m),"show-tooltip":!0,step:a.sensiStep,min:a.sensiMin,max:a.sensiMax,"show-input":""},null,8,["modelValue","step","min","max"])]),_:1})):f("",!0),q,a.firmVersion>=10?(p(),_(g,{key:4},{default:x(()=>[d("div",F,[J,i(c,{style:{float:"right"},type:"primary",disabled:!a.connected,onClick:n.writeBrightness},{default:x(()=>[h("写入亮度配置")]),_:1},8,["disabled","onClick"])]),i(w,{modelValue:a.brightness,"onUpdate:modelValue":r[4]||(r[4]=m=>a.brightness=m),"show-tooltip":!1,step:1,min:0,marks:a.brightnessMark,max:10},null,8,["modelValue","marks"])]),_:1})):f("",!0),K,f("",!0),a.firmVersion>=11?(p(),_(g,{key:6},{default:x(()=>[d("div",Q,[Y,i(c,{style:{float:"right"},type:"primary",disabled:!a.connected,onClick:n.writeKeyLayout},{default:x(()=>[h("写入键型配置")]),_:1},8,["disabled","onClick"])]),Z,i(l,{title:"提示",type:"info",description:"键型：32k为几乎覆盖全键盘，8k为asdfjkl;，4k为dfjk。","show-icon":""}),i(w,{modelValue:a.keyType,"onUpdate:modelValue":r[7]||(r[7]=m=>a.keyType=m),"show-tooltip":!1,step:1,min:1,marks:a.keyTypeMark,max:4},null,8,["modelValue","marks"])]),_:1})):f("",!0),a.firmVersion>=13?(p(),_(g,{key:7},{default:x(()=>[d("div",G,[$,i(c,{style:{float:"right"},type:"primary",disabled:!a.connected,onClick:n.writeSliderLatency},{default:x(()=>[h("写入键型配置")]),_:1},8,["disabled","onClick"])]),ee,i(l,{title:"提示",type:"info",description:"Slider延迟，用于平衡air延迟使用，可以设置0-14档，每档大约3ms","show-icon":""}),i(w,{modelValue:a.sliderLatency,"onUpdate:modelValue":r[8]||(r[8]=m=>a.sliderLatency=m),"show-tooltip":!1,step:1,min:0,marks:a.sliderLatencyMark,max:14},null,8,["modelValue","marks"])]),_:1})):f("",!0),a.connected&&a.debugEnabled?(p(),_(g,{key:8},{default:x(()=>[ae,i(y,{modelValue:a.eepromAddr,"onUpdate:modelValue":r[9]||(r[9]=m=>a.eepromAddr=m),min:0,max:255,label:"地址"},null,8,["modelValue"]),i(y,{modelValue:a.eepromValue,"onUpdate:modelValue":r[10]||(r[10]=m=>a.eepromValue=m),min:0,max:255,label:"值"},null,8,["modelValue"]),i(c,{type:"primary",onClick:n.readEEPROM},{default:x(()=>[h("读取")]),_:1},8,["onClick"]),i(c,{type:"danger",onClick:n.writeEEPROM},{default:x(()=>[h("写入")]),_:1},8,["onClick"])]),_:1})):f("",!0)],64)}const le=W(A,[["render",te]]);export{le as default};
