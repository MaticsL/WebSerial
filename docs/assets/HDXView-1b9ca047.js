import{_ as B,r as d,o as h,c as y,a as o,b as e,w as u,e as D,d as m,F as S,f as p,t as E}from"./index-6eb9c4ea.js";const C={data(){return{headMessageType:"warning",lastmessage:"请选择设备",portNum:null,connected:!0,halting:!1,touchingArea:["A1","A5","E8"],touchingIntervalID:0,readingData:new Uint8Array,RatioSetting:{area:null,value:null},SensitivitySetting:{area:null,value:null},debugEnabledCount:0,debugEnabled:!1}},methods:{debugenable(){this.debugEnabledCount+=1,this.debugEnabledCount>=5&&(this.debugEnabled=!0)},submitRatio(){this.RatioSetting.area==null||this.RatioSetting.value==null},submitSensitivity(){},async factoryMode(){let a=this;if("serial"in navigator){try{a.portNum=await navigator.serial.requestPort()}catch(n){a.lastmessage="端口选择错误："+n;return}try{await a.portNum.open({baudRate:1200}),await a.portNum.setSignals({dataTerminalReady:!1})}catch(n){a.lastmessage="打开端口错误："+n;return}a.lastmessage="成功，请检查控制器盘符并放入固件",a.headMessageType="success"}},asciiToUint8(a){let n="";for(let s=0;s<a.length;s++){const b=a.charCodeAt(s).toString(16).padStart(2,"0");n+=b+" "}return n=n.trim(),Uint8Array.from(n.split(" ").map(s=>parseInt(s,16)))},test(){console.log(this.asciiToUint8("{LAr2}"))},async startTouchListening(){let a=this;for(;!this.halting;){let n=a.portNum.getReader();for(;;){const{value:t,done:s}=await n.read();if(s)break;a.readingData=new Uint8Array,t[7]&1&&a.readingData.push("A1"),t[7]&2&&a.readingData.push("A2"),t[7]&4&&a.readingData.push("A3"),t[7]&8&&a.readingData.push("A4"),t[7]&16&&a.readingData.push("A5"),t[6]&1&&a.readingData.push("A6"),t[6]&2&&a.readingData.push("A7"),t[6]&4&&a.readingData.push("A8"),t[6]&8&&a.readingData.push("B1"),t[6]&16&&a.readingData.push("B2"),t[5]&1&&a.readingData.push("B3"),t[5]&2&&a.readingData.push("B4"),t[5]&4&&a.readingData.push("B5"),t[5]&8&&a.readingData.push("B6"),t[5]&16&&a.readingData.push("B7"),t[4]&1&&a.readingData.push("B8"),t[4]&2&&a.readingData.push("C1"),t[4]&4&&a.readingData.push("C2"),t[4]&8&&a.readingData.push("D1"),t[4]&16&&a.readingData.push("D2"),t[3]&1&&a.readingData.push("D3"),t[3]&2&&a.readingData.push("D4"),t[3]&4&&a.readingData.push("D5"),t[3]&8&&a.readingData.push("D6"),t[3]&16&&a.readingData.push("D7"),t[2]&1&&a.readingData.push("D8"),t[2]&2&&a.readingData.push("E1"),t[2]&4&&a.readingData.push("E2"),t[2]&8&&a.readingData.push("E3"),t[2]&16&&a.readingData.push("E4"),t[1]&1&&a.readingData.push("E5"),t[1]&2&&a.readingData.push("E6"),t[1]&4&&a.readingData.push("E7"),t[1]&8&&a.readingData.push("E8")}}},async choosePort(){let a=this;if(this.connected==!0){this.halting==!0?(this.asciiToUint8("{STAT}"),this.halting=!this.halting,a.lastmessage="退出配置设置",this.startTouchListening()):(this.asciiToUint8("{HALT}"),this.halting=!this.halting,a.lastmessage="退出屏幕测试");return}if("serial"in navigator){try{a.portNum=await navigator.serial.requestPort()}catch(i){a.lastmessage="端口选择错误："+i;return}try{await a.portNum.open({baudRate:1e6})}catch(i){a.lastmessage="打开端口错误："+i;return}a.connecting=!0,a.connectPercentage=0;let n=a.asciiToUint8("{RSET}"),t=a.asciiToUint8("{HALT}"),s=a.portNum.writable.getWriter();await s.write(n),await s.write(t),connected=!connected,a.lastmessage="成功连接",a.headMessageType="success",a.startTouchListening()}else a.lastmessage="您的浏览器不支持串口通信，请使用chrome浏览器。"}}},w=o("br",null,null,-1),T=o("br",null,null,-1),V=o("h2",null,"触摸区域",-1),k=o("br",null,null,-1),R=o("h3",null,"设置Ratio",-1),U=o("br",null,null,-1),N=o("h3",null,"设置Sensitivity",-1);function L(a,n,t,s,i,b){const x=d("el-divider"),_=d("el-alert"),g=d("el-button"),v=d("el-col"),f=d("el-row"),A=d("el-card"),l=d("el-option"),c=d("el-select");return h(),y(S,null,[o("h2",{onClick:n[0]||(n[0]=(...r)=>b.debugenable&&b.debugenable(...r))},"HDX 配置"),e(x),e(_,{title:"提示",type:"info",description:"本页面提供 HDX 乌蒙风格控制器的配置功能。请确认您的控制器符合这个版本。完成配置后，您可以直接关闭这个页面。","show-icon":""}),w,e(f,null,{default:u(()=>[e(v,{span:4},{default:u(()=>[e(g,{onClick:b.factoryMode},{default:u(()=>[p("进入刷机模式")]),_:1},8,["onClick"])]),_:1}),i.debugEnabled?(h(),D(v,{key:0,span:4},{default:u(()=>[e(g,{onClick:b.choosePort},{default:u(()=>[p(E(i.connected?i.halting?"进入屏幕测试":"进入配置设置":"连接控制器"),1)]),_:1},8,["onClick"])]),_:1})):m("",!0),e(v,{span:16},{default:u(()=>[e(_,{title:i.lastmessage,type:i.headMessageType,closable:!1},null,8,["title","type"])]),_:1})]),_:1}),T,i.connected&&!i.halting&&i.debugEnabled?(h(),D(A,{key:0,id:"screen-testing"},{default:u(()=>[V,o("div",null,E(i.touchingArea),1),k]),_:1})):m("",!0),i.connected&&i.halting&&i.debugEnabled?(h(),D(A,{key:1,id:"settings-changing"},{default:u(()=>[R,e(f,{gutter:20},{default:u(()=>[e(v,{span:8},{default:u(()=>[e(c,{modelValue:i.RatioSetting.area,"onUpdate:modelValue":n[1]||(n[1]=r=>i.RatioSetting.area=r),placeholder:"触摸区域",inline:!0},{default:u(()=>[e(l,{label:"A1",value:"A1"}),e(l,{label:"A2",value:"A2"}),e(l,{label:"A3",value:"A3"}),e(l,{label:"A4",value:"A4"}),e(l,{label:"A5",value:"A5"}),e(l,{label:"A6",value:"A6"}),e(l,{label:"A7",value:"A7"}),e(l,{label:"A8",value:"A8"}),e(l,{label:"B1",value:"B1"}),e(l,{label:"B2",value:"B2"}),e(l,{label:"B3",value:"B3"}),e(l,{label:"B4",value:"B4"}),e(l,{label:"B5",value:"B5"}),e(l,{label:"B6",value:"B6"}),e(l,{label:"B7",value:"B7"}),e(l,{label:"B8",value:"B8"}),e(l,{label:"C1",value:"C1"}),e(l,{label:"C2",value:"C2"}),e(l,{label:"D1",value:"D1"}),e(l,{label:"D2",value:"D2"}),e(l,{label:"D3",value:"D3"}),e(l,{label:"D4",value:"D4"}),e(l,{label:"D5",value:"D5"}),e(l,{label:"D6",value:"D6"}),e(l,{label:"D7",value:"D7"}),e(l,{label:"D8",value:"D8"}),e(l,{label:"E1",value:"E1"}),e(l,{label:"E2",value:"E2"}),e(l,{label:"E3",value:"E3"}),e(l,{label:"E4",value:"E4"}),e(l,{label:"E5",value:"E5"}),e(l,{label:"E6",value:"E6"}),e(l,{label:"E7",value:"E7"}),e(l,{label:"E8",value:"E8"})]),_:1},8,["modelValue"])]),_:1}),e(v,{span:8},{default:u(()=>[e(c,{modelValue:i.RatioSetting.value,"onUpdate:modelValue":n[2]||(n[2]=r=>i.RatioSetting.value=r),placeholder:"值",inline:!0},{default:u(()=>[e(l,{label:"-5",value:"-5"}),e(l,{label:"-4",value:"-4"}),e(l,{label:"-3",value:"-3"}),e(l,{label:"-2",value:"-2"}),e(l,{label:"-1",value:"-1"}),e(l,{label:"0",value:"0"}),e(l,{label:"1",value:"1"}),e(l,{label:"2",value:"2"}),e(l,{label:"3",value:"3"}),e(l,{label:"4",value:"4"}),e(l,{label:"5",value:"5"})]),_:1},8,["modelValue"])]),_:1}),e(g,{span:4,onClick:b.submitRatio},{default:u(()=>[p(" Submit ")]),_:1},8,["onClick"])]),_:1}),U,N,e(f,{gutter:20},{default:u(()=>[e(v,{span:8},{default:u(()=>[e(c,{modelValue:i.SensitivitySetting.area,"onUpdate:modelValue":n[3]||(n[3]=r=>i.SensitivitySetting.area=r),placeholder:"触摸区域",inline:!0},{default:u(()=>[e(l,{label:"A1",value:"0x41"}),e(l,{label:"A3",value:"0x42"}),e(l,{label:"A2",value:"0x43"}),e(l,{label:"A4",value:"0x44"}),e(l,{label:"A5",value:"0x45"}),e(l,{label:"A6",value:"0x46"}),e(l,{label:"A7",value:"0x47"}),e(l,{label:"A8",value:"0x48"}),e(l,{label:"B1",value:"0x49"}),e(l,{label:"B2",value:"0x50"}),e(l,{label:"B3",value:"0x51"}),e(l,{label:"B4",value:"0x52"}),e(l,{label:"B5",value:"0x53"}),e(l,{label:"B6",value:"0x54"}),e(l,{label:"B7",value:"0x55"}),e(l,{label:"B8",value:"0x56"}),e(l,{label:"C1",value:"0x57"}),e(l,{label:"C2",value:"0x58"}),e(l,{label:"D1",value:"0x59"}),e(l,{label:"D2",value:"0x60"}),e(l,{label:"D3",value:"0x61"}),e(l,{label:"D4",value:"0x62"}),e(l,{label:"D5",value:"0x63"}),e(l,{label:"D6",value:"0x64"}),e(l,{label:"D7",value:"0x65"}),e(l,{label:"D8",value:"0x66"}),e(l,{label:"E1",value:"0x67"}),e(l,{label:"E2",value:"0x68"}),e(l,{label:"E3",value:"0x69"}),e(l,{label:"E4",value:"0x70"}),e(l,{label:"E5",value:"0x71"}),e(l,{label:"E6",value:"0x72"}),e(l,{label:"E7",value:"0x73"}),e(l,{label:"E8",value:"0x74"})]),_:1},8,["modelValue"])]),_:1}),e(v,{span:8},{default:u(()=>[e(c,{modelValue:i.SensitivitySetting.value,"onUpdate:modelValue":n[4]||(n[4]=r=>i.SensitivitySetting.value=r),placeholder:"值",inline:!0},{default:u(()=>[e(l,{label:"-5",value:"-5"}),e(l,{label:"-4",value:"-4"}),e(l,{label:"-3",value:"-3"}),e(l,{label:"-2",value:"-2"}),e(l,{label:"-1",value:"-1"}),e(l,{label:"0",value:"0"}),e(l,{label:"1",value:"1"}),e(l,{label:"2",value:"2"}),e(l,{label:"3",value:"3"}),e(l,{label:"4",value:"4"}),e(l,{label:"5",value:"5"})]),_:1},8,["modelValue"])]),_:1}),e(g,{span:4,onClick:b.submitSensitivity},{default:u(()=>[p(" Submit ")]),_:1},8,["onClick"])]),_:1})]),_:1})):m("",!0)],64)}const M=B(C,[["render",L]]);export{M as default};
